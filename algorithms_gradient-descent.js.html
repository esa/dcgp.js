<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: algorithms/gradient-descent.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: algorithms/gradient-descent.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { stackPutArray, flatten2D } from '../helpers'
import { getInstance } from '../initialiser'

/**
 * @typedef {import('../classes/Expression').default} Expression
 */

/**
 * @function gradientDescent
 * @memberof Algorithm
 * @param {Expression} expression Expression to evolve the constants of.
 * @param {number} learningRate Rate at which the constants will update.
 * @param {number} maxSteps Maximum amount of steps before the algorithm stop.
 * The algorithm could stop before `maxSteps` if a loss of lower than 1e-13 is reached.
 * @param {[[number]]} inputs Matrix with dimentions (inputs, points). The inputs should exclude the constants.
 * @param {[[number]]} labels Matrix with dimentions (outputs, points).
 * @param {number[]} [constants] Array with ephemeral constants to be used as inputs together with `inputs`.
 * The gradient descent algorithm will learn the constants to minimize the Mean Squared Error.
 * @returns {object}
 */
function gradientDescent(
  expression,
  learningRate,
  maxSteps,
  inputs,
  labels,
  constants = []
) {
  if (inputs.length + constants.length !== expression.inputs) {
    throw 'The number of provided inputs is not equal to the required inputs for this expression.'
  }

  if (inputs[0].length !== labels[0].length) {
    throw 'input and output must be an array of the same length. ' +
      `Lengths ${inputs.length} and ${labels.length} found.`
  }

  const {
    memory: { F64 },
    exports: { stackSave, stackRestore, _algorithm_gradient_descent },
  } = getInstance()

  const stackStart = stackSave()

  const [inputsPointer, labelsPointer] = [inputs, labels].map(data => {
    const flat = flatten2D(data)

    return stackPutArray(flat, F64)
  })

  const constantsPointer =
    constants.length !== 0 ? stackPutArray(constants, F64) : 0

  const loss = _algorithm_gradient_descent(
    expression.pointer,
    learningRate,
    maxSteps,
    inputsPointer,
    labelsPointer,
    inputs[0].length,
    constantsPointer,
    constants.length
  )

  const typedLearnedConstants = new Float64Array(
    F64.buffer,
    constantsPointer,
    constants.length
  )

  const learnedConstants = Array.from(typedLearnedConstants)

  stackRestore(stackStart)
  return {
    loss,
    constants: learnedConstants,
  }
}

export default gradientDescent
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Expression.html">Expression</a></li><li><a href="Kernel.html">Kernel</a></li><li><a href="KernelSet.html">KernelSet</a></li></ul><h3>Namespaces</h3><ul><li><a href="Algorithm.html">Algorithm</a></li></ul><h3>Global</h3><ul><li><a href="global.html#initialise">initialise</a></li><li><a href="global.html#stackPutArray">stackPutArray</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sat Apr 13 2019 21:26:31 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
